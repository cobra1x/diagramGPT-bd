from diagrams import Diagram, Edge\nfrom diagrams.aws.compute import Lambda\nfrom diagrams.aws.storage import S3\nfrom diagrams.onprem.compute import Server\nfrom diagrams.onprem.database import PostgreSQL\nfrom diagrams.onprem.network import Internet\n\nwith Diagram(\"Software Design\", show=False, filename=\"static/gpt_generated_diagram\"):\n    frontend_ui = Internet(\"Frontend UI\\n(React.js/Next.js)\")\n    backend_api_service = Server(\"Backend API Service\\n(Node.js/Express)\")\n    ai_feedback_engine = Lambda(\"AI/ML Feedback Engine\\n(AWS Rekognition, Transcribe, SageMaker)\")\n    auth_service = Server(\"Authentication & Authorization\\n(JWT, Auth0)\")\n    db_service = PostgreSQL(\"Database Service\\n(PostgreSQL)\")\n    media_storage = S3(\"Media Storage Service\\n(AWS S3)\")\n\n    # 1. User Authentication and Session Management\n    frontend_ui >> Edge(label=\"1. User Login/Register\") >> auth_service\n    auth_service >> Edge(label=\"2. Auth Token issued\") >> frontend_ui\n    frontend_ui >> Edge(label=\"3. API Requests (with Auth Token)\") >> backend_api_service\n    backend_api_service >> Edge(label=\"4. Validate Auth Token\") >> auth_service\n\n    # 2. Core Data Management\n    backend_api_service >> Edge(label=\"CRUD (Users, Sessions, Questions, Reports)\") >> db_service\n\n    # 3. Media Recording and Storage\n    backend_api_service >> Edge(label=\"5. Request pre-signed URL for upload\", style=\"dashed\") >> media_storage\n    frontend_ui >> Edge(label=\"6. Upload Video Recording\") >> media_storage\n\n    # 4. AI/ML Feedback Generation\n    backend_api_service >> Edge(label=\"7. Trigger Analysis (Video ID)\") >> ai_feedback_engine\n    ai_feedback_engine >> Edge(label=\"8. Read Video Recording for Processing\") >> media_storage\n    ai_feedback_engine >> Edge(label=\"9. Return Feedback Analysis Results\") >> backend_api_service\n    backend_api_service >> Edge(label=\"10. Store Feedback Reports\") >> db_service